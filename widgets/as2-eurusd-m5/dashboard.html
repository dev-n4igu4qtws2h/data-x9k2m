<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>AS-2 EURUSD M5 Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --border-primary: #30363d;
            --text-primary: #c9d1d9;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --color-win: #3fb950;
            --color-loss: #f85149;
            --color-neutral: #58a6ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .header p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .timeframe-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .timeframe-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            color: var(--text-primary);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .timeframe-btn:hover {
            background: var(--bg-tertiary);
            border-color: var(--color-neutral);
        }

        .timeframe-btn.active {
            background: var(--color-neutral);
            color: white;
            border-color: var(--color-neutral);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 20px;
        }

        .card-title {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .gauge-container {
            height: 250px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-primary);
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: 600;
        }

        .stat-value.win {
            color: var(--color-win);
        }

        .stat-value.loss {
            color: var(--color-loss);
        }

        .chart-container {
            width: 100%;
            margin-bottom: 20px;
        }

        .equity-card {
            grid-column: 1 / -1;
        }

        .equity-chart {
            height: 350px;
            margin-top: 15px;
        }

        .footer {
            text-align: center;
            color: var(--text-muted);
            font-size: 12px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-primary);
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .timeframe-buttons {
                gap: 8px;
            }
            
            .timeframe-btn {
                padding: 6px 12px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>AS-2 EURUSD M5</h1>
            <p>Live Trading Dashboard</p>
        </div>

        <div class="timeframe-buttons">
            <button class="timeframe-btn active" data-timeframe="overall">Max</button>
            <button class="timeframe-btn" data-timeframe="ytd">YTD</button>
            <button class="timeframe-btn" data-timeframe="this_month">This Month</button>
            <button class="timeframe-btn" data-timeframe="last_month">Last Month</button>
            <button class="timeframe-btn" data-timeframe="last_week">Last Week</button>
        </div>

        <div class="stats-grid">
            <div class="card">
                <div class="card-title">Winrate</div>
                <div class="gauge-container">
                    <div id="gaugeChart"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">Statistics</div>
                <div class="stat-row">
                    <span class="stat-label">Total Trades</span>
                    <span class="stat-value" id="totalTrades">-</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Winners</span>
                    <span class="stat-value win" id="winners">-</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Losers</span>
                    <span class="stat-value loss" id="losers">-</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Win Rate</span>
                    <span class="stat-value" id="winRate">-</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">W/L Ratio</span>
                    <span class="stat-value" id="wlRatio">-</span>
                </div>
            </div>
        </div>

        <div class="card equity-card">
            <div class="card-title">Equity Curve</div>
            <div class="equity-chart">
                <div id="equityChart"></div>
            </div>
        </div>

        <div class="footer">
            <p>Last updated: <span id="lastUpdated">-</span></p>
            <p>Auto-refresh every 60 seconds</p>
        </div>
    </div>

    <script>
        let gaugeChart;
        let equityChart;
        let allData = null;
        let currentTimeframe = 'overall';

        // Initialize Gauge Chart
        function initGaugeChart() {
            const options = {
                series: [0],
                chart: {
                    type: 'radialBar',
                    height: 250,
                    background: 'transparent'
                },
                plotOptions: {
                    radialBar: {
                        startAngle: -135,
                        endAngle: 135,
                        hollow: {
                            size: '65%',
                        },
                        track: {
                            background: '#21262d',
                            strokeWidth: '100%',
                        },
                        dataLabels: {
                            name: {
                                fontSize: '14px',
                                color: '#8b949e',
                                offsetY: -10
                            },
                            value: {
                                fontSize: '32px',
                                color: '#c9d1d9',
                                offsetY: 5,
                                formatter: function(val) {
                                    return val.toFixed(1) + '%';
                                }
                            }
                        }
                    }
                },
                fill: {
                    type: 'gradient',
                    gradient: {
                        shade: 'dark',
                        type: 'horizontal',
                        shadeIntensity: 0.5,
                        gradientToColors: ['#3fb950'],
                        inverseColors: false,
                        opacityFrom: 1,
                        opacityTo: 1,
                        stops: [0, 100]
                    }
                },
                stroke: {
                    lineCap: 'round'
                },
                labels: ['Win Rate'],
                theme: {
                    mode: 'dark'
                }
            };

            gaugeChart = new ApexCharts(document.querySelector("#gaugeChart"), options);
            gaugeChart.render();
        }

        // Initialize Equity Chart
        function initEquityChart() {
            const options = {
                series: [{
                    name: 'Equity',
                    data: []
                }],
                chart: {
                    type: 'area',
                    height: 350,
                    background: 'transparent',
                    toolbar: {
                        show: false
                    },
                    zoom: {
                        enabled: false
                    }
                },
                stroke: {
                    curve: 'smooth',
                    width: 2,
                    colors: ['#3fb950']
                },
                fill: {
                    type: 'gradient',
                    gradient: {
                        shade: 'dark',
                        type: 'vertical',
                        shadeIntensity: 0.5,
                        gradientToColors: ['#0d1117'],
                        inverseColors: false,
                        opacityFrom: 0.8,
                        opacityTo: 0.1,
                        stops: [0, 100]
                    }
                },
                markers: {
                    size: 0
                },
                dataLabels: {
                    enabled: false
                },
                xaxis: {
                    type: 'datetime',
                    labels: {
                        style: {
                            colors: '#8b949e',
                            fontSize: '12px'
                        },
                        datetimeUTC: false
                    },
                    axisBorder: {
                        color: '#30363d'
                    },
                    axisTicks: {
                        color: '#30363d'
                    }
                },
                yaxis: {
                    labels: {
                        style: {
                            colors: '#8b949e',
                            fontSize: '12px'
                        },
                        formatter: function(val) {
                            return '€' + val.toFixed(0);
                        }
                    }
                },
                grid: {
                    borderColor: '#30363d',
                    strokeDashArray: 3,
                    xaxis: {
                        lines: {
                            show: true
                        }
                    },
                    yaxis: {
                        lines: {
                            show: true
                        }
                    }
                },
                tooltip: {
                    theme: 'dark',
                    x: {
                        format: 'dd MMM yyyy'
                    },
                    y: {
                        formatter: function(val) {
                            return '€' + val.toFixed(2);
                        }
                    }
                },
                theme: {
                    mode: 'dark'
                }
            };

            equityChart = new ApexCharts(document.querySelector("#equityChart"), options);
            equityChart.render();
        }

        // Update Dashboard
        function updateDashboard(timeframe) {
            if (!allData || !allData[timeframe]) return;

            const data = allData[timeframe];
            const equity = allData.equity[timeframe];

            // Update gauge
            gaugeChart.updateSeries([data.winrate]);

            // Update stats
            document.getElementById('totalTrades').textContent = data.total;
            document.getElementById('winners').textContent = data.wins;
            document.getElementById('losers').textContent = data.losses;
            document.getElementById('winRate').textContent = data.winrate.toFixed(1) + '%';
            
            const wlRatio = data.losses > 0 ? (data.wins / data.losses).toFixed(2) : data.wins;
            document.getElementById('wlRatio').textContent = wlRatio;

            // Update equity chart
            if (equity && equity.length > 0) {
                const chartData = equity.map(point => ({
                    x: new Date(point.date).getTime(),
                    y: point.equity
                }));

                equityChart.updateSeries([{
                    name: 'Equity',
                    data: chartData
                }]);
            } else {
                equityChart.updateSeries([{
                    name: 'Equity',
                    data: []
                }]);
            }

            // Update timestamp
            if (allData.last_updated) {
                const date = new Date(allData.last_updated);
                document.getElementById('lastUpdated').textContent = date.toLocaleString('de-DE');
            }
        }

        // Load data
        async function loadData() {
            try {
                const response = await fetch('../../data/as2-eurusd-m5.json?t=' + Date.now());
                allData = await response.json();
                updateDashboard(currentTimeframe);
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        // Timeframe button handlers
        document.querySelectorAll('.timeframe-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.timeframe-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentTimeframe = this.dataset.timeframe;
                updateDashboard(currentTimeframe);
            });
        });

        // Initialize
        initGaugeChart();
        initEquityChart();
        loadData();

        // Auto-refresh every 60 seconds
        setInterval(loadData, 60000);
    </script>
</body>
</html>
